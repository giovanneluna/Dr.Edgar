/* === CORREÇÕES ESPECÍFICAS PARA iOS === */

/* Variáveis CSS para altura do viewport em iOS */
:root {
  --vh: 1vh;
}

/* Detecção de iOS */
@supports (-webkit-touch-callout: none) {

  /* Correções gerais para iOS */
  html.ios-device,
  body.ios-device {
    -webkit-overflow-scrolling: touch;
    -webkit-text-size-adjust: 100%;
    height: 100%;
    overflow-x: hidden;
    /* Usar altura customizada do viewport */
    min-height: calc(var(--vh, 1vh) * 100);
  }

  /* Correções para o viewport em iOS */
  .ios-device {
    /* Prevenir zoom acidental */
    touch-action: manipulation;
    /* Melhorar performance de scroll */
    -webkit-overflow-scrolling: touch;
  }

  /* Correções para a seção de especialidades */
  .container-section-especialidade-premium {
    /* Força renderização por hardware */
    -webkit-transform: translate3d(0, 0, 0);
    transform: translate3d(0, 0, 0);
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;

    /* Remove backdrop-filter que pode causar problemas */
    -webkit-backdrop-filter: none !important;
    backdrop-filter: none !important;

    /* Garantir visibilidade total da seção */
    position: relative;
    z-index: 1;
    width: 100%;
    overflow: visible;

    /* Padding adicional para iOS */
    padding-top: env(safe-area-inset-top, 20px);
    padding-bottom: env(safe-area-inset-bottom, 20px);
  }

  /* Correções específicas para o cabeçalho da seção */
  .especialidade-premium-header {
    /* Garantir que o cabeçalho seja sempre visível */
    position: relative;
    z-index: 2;
    padding: 20px 15px;
    text-align: center;
  }

  /* Correções para o badge "PRINCIPAIS SOLUÇÕES" */
  .especialidade-badge {
    /* Garantir visibilidade do badge */
    display: inline-block !important;
    visibility: visible !important;
    opacity: 1 !important;
    background: rgba(201, 99, 50, 0.9) !important;
    color: white !important;
    padding: 8px 16px !important;
    border-radius: 20px !important;
    font-size: 12px !important;
    font-weight: 600 !important;
    text-transform: uppercase !important;
    letter-spacing: 1px !important;
    margin-bottom: 16px !important;
  }

  /* Correções para os cards */
  .especialidade-premium-card {
    /* Força renderização por hardware */
    -webkit-transform: translate3d(0, 0, 0);
    transform: translate3d(0, 0, 0);
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;

    /* Background sólido como fallback para iOS */
    background: rgba(255, 255, 255, 0.15) !important;
    -webkit-backdrop-filter: none !important;
    backdrop-filter: none !important;

    /* Borda mais visível para iOS */
    border: 1px solid rgba(255, 255, 255, 0.4) !important;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2) !important;

    /* Remove will-change que pode causar problemas */
    will-change: auto !important;

    /* Garantir visibilidade */
    position: relative !important;
    z-index: 1 !important;
  }

  /* Correções para imagens */
  .card-premium-image-container {
    -webkit-transform: translate3d(0, 0, 0);
    transform: translate3d(0, 0, 0);
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
  }

  .card-premium-image-container img {
    /* Remove transforms que podem falhar */
    -webkit-transform: none !important;
    transform: none !important;

    /* Força renderização */
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;

    /* Remove lazy loading */
    loading: auto !important;

    /* Garante visibilidade */
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
  }

  /* Remove hover effects em dispositivos touch */
  .especialidade-premium-card:hover {
    -webkit-transform: translate3d(0, 0, 0) !important;
    transform: translate3d(0, 0, 0) !important;
  }

  .especialidade-premium-card:hover .card-premium-image-container img {
    -webkit-transform: none !important;
    transform: none !important;
  }

  /* Correções para grid */
  .especialidade-premium-grid {
    /* Remove contain que pode causar problemas */
    contain: none !important;
  }

  /* Correções para fontes */
  .container-section-especialidade-premium *,
  .especialidade-premium-header *,
  .especialidade-premium-card *,
  .card-premium-content * {
    -webkit-font-smoothing: antialiased !important;
    -moz-osx-font-smoothing: grayscale !important;
    font-display: swap !important;
  }

  /* Correções para textos que podem não aparecer */
  .card-premium-title,
  .card-premium-subtitle,
  .card-premium-description,
  .especialidade-premium-title,
  .especialidade-premium-subtitle {
    /* Força renderização de texto */
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    text-rendering: optimizeLegibility;

    /* Garante visibilidade */
    opacity: 1 !important;
    visibility: visible !important;
    display: block !important;

    /* Remove text-fill-color que pode causar problemas */
    -webkit-text-fill-color: unset !important;
    color: inherit !important;
  }

  /* Específico para títulos com gradient */
  .highlight-especialidade {
    /* Fallback para gradients que podem não funcionar */
    background: none !important;
    -webkit-background-clip: unset !important;
    background-clip: unset !important;
    -webkit-text-fill-color: white !important;
    color: white !important;
    font-weight: 600 !important;
  }

  /* Corrigir problemas de rendering de texto específicos para iOS */
  .especialidade-premium-title,
  .card-premium-title {
    /* Força renderização de texto */
    -webkit-text-stroke: 0.5px rgba(255, 255, 255, 0.1);
    text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3) !important;
    color: white !important;
    -webkit-text-fill-color: white !important;
  }

  /* Garantir que o badge seja sempre visível */
  .especialidade-badge {
    /* Fallback sólido para gradientes */
    background: #c96332 !important;
    background-image: none !important;
    color: white !important;
    display: inline-block !important;
    visibility: visible !important;
    opacity: 1 !important;
    font-weight: 700 !important;
    text-transform: uppercase !important;
    font-size: 12px !important;
    padding: 10px 20px !important;
    border-radius: 25px !important;
    margin-bottom: 20px !important;
  }

  /* Correções para ícones emoji */
  .icon-circle span {
    /* Força renderização de emoji */
    font-family: "Apple Color Emoji", "Segoe UI Emoji", sans-serif !important;
    font-size: 24px !important;
    line-height: 1 !important;
    display: block !important;
  }

  /* Correções para botões */
  .card-premium-button {
    /* Remove transforms que podem causar problemas */
    -webkit-transform: none !important;
    transform: none !important;

    /* Força renderização */
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;

    /* Garante interação touch */
    -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1);
    cursor: pointer;
  }
}

/* Específico para iPhone (telas menores que 768px e iOS) */
@media screen and (max-width: 768px) {
  @supports (-webkit-touch-callout: none) {
    .especialidade-premium-card {
      /* Máxima compatibilidade para mobile iOS */
      width: 100% !important;
      max-width: 400px !important;
      margin: 0 auto 25px auto !important;
    }

    .card-premium-image-container {
      height: 180px !important;
      overflow: hidden !important;
    }

    .card-premium-image-container img {
      width: 100% !important;
      height: 100% !important;
      object-fit: cover !important;
      object-position: center !important;
    }

    .card-premium-content {
      padding: 25px 20px !important;
      text-align: center !important;
    }

    .card-premium-icon {
      position: static !important;
      margin: 0 auto 20px auto !important;
    }
  }
}

/* Específico para iPhone 12/13/14 Pro (390px de largura) */
@media screen and (max-width: 428px) and (min-width: 375px) {
  @supports (-webkit-touch-callout: none) {

    /* Correções para iPhone 12 e similares */
    body.ios-device {
      /* Prevenir problemas de layout */
      width: 100%;
      overflow-x: hidden;
      position: relative;
    }

    .container-section-especialidade-premium {
      /* Garantir que a seção seja totalmente visível */
      margin: 0 !important;
      padding: env(safe-area-inset-top, 20px) 15px env(safe-area-inset-bottom, 20px) 15px !important;
      min-height: auto !important;
      overflow: visible !important;
      box-sizing: border-box !important;
    }

    .especialidade-premium-header {
      padding: 20px 10px !important;
      margin: 0 !important;
    }

    .especialidade-premium-title {
      font-size: 24px !important;
      line-height: 1.3 !important;
      margin: 16px 0 !important;
      padding: 0 10px !important;
    }

    .especialidade-premium-subtitle {
      font-size: 16px !important;
      line-height: 1.5 !important;
      margin: 0 0 30px 0 !important;
      padding: 0 10px !important;
    }

    /* Grid responsivo para iPhone 12 */
    .especialidade-premium-grid {
      display: block !important;
      gap: 20px !important;
      padding: 0 !important;
      margin: 0 !important;
    }

    .especialidade-premium-card {
      width: 100% !important;
      max-width: none !important;
      margin: 0 0 25px 0 !important;
      border-radius: 12px !important;
      overflow: hidden !important;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1) !important;
    }
  }
}

/* Debug para desenvolvimento - remover em produção */
.debug-ios {
  border: 2px solid red !important;
  background: rgba(255, 0, 0, 0.1) !important;
}

/* Força carregamento de imagens JPG como fallback */
img[src*=".avif"] {
  background-color: #f0f0f0;
  min-height: 160px;
}

/* Animações mais suaves para iOS */
@supports (-webkit-touch-callout: none) {
  * {
    -webkit-animation-duration: 0.3s !important;
    animation-duration: 0.3s !important;
    -webkit-transition-duration: 0.3s !important;
    transition-duration: 0.3s !important;
  }
}

/* Força repintura para iOS após carregamento da página */
@supports (-webkit-touch-callout: none) {
  body.ios-device.loaded {
    opacity: 1;
    visibility: visible;
  }

  body.ios-device:not(.loaded) {
    opacity: 0.99;
  }

  /* Força renderização imediata dos elementos críticos */
  .ios-device .container-section-especialidade-premium,
  .ios-device .especialidade-premium-header,
  .ios-device .especialidade-premium-card {
    /* Força criação de layer de composição */
    will-change: transform;
    -webkit-transform: translateZ(0);
    transform: translateZ(0);
  }

  /* Após carregamento, remove will-change para economizar memória */
  .ios-device.loaded .container-section-especialidade-premium,
  .ios-device.loaded .especialidade-premium-header,
  .ios-device.loaded .especialidade-premium-card {
    will-change: auto;
  }
}